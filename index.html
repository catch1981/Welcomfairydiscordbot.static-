<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Coven Zero — Entry</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#0a0a0c; --ink:#eaeaea; --muted:#b6b6c2; --accent:#9a6bff;
      --veil:rgba(0,0,0,.45); --veil-strong:rgba(0,0,0,.68);
    }
    html,body{height:100%;margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif}
    button{cursor:pointer;border:1px solid var(--accent);background:transparent;color:var(--ink);
           padding:12px 18px;border-radius:10px;font-weight:600;letter-spacing:.3px}
    button:disabled{opacity:.5;cursor:not-allowed}
    .screen{position:fixed;inset:0;display:none;align-items:center;justify-content:center;overflow:hidden}
    .screen.active{display:flex}
    .stage{position:relative;width:min(1000px,92vw);padding:24px}
    .card{background:var(--veil-strong);backdrop-filter:blur(6px);border:1px solid #2a2a37;border-radius:16px;
          padding:22px 20px;box-shadow:0 10px 30px rgba(0,0,0,.45)}
    .title{font-size:clamp(22px,3.6vw,34px);margin:0 0 8px 0}
    .para{color:var(--muted);line-height:1.5;margin:8px 0 18px 0}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    /* fairy bg */
    .bg{
      position:absolute;inset:0;background:#09090b center/cover no-repeat;
      filter:saturate(1.05) contrast(1.02) brightness(.92);
      z-index:0;
    }
    .bg::after{content:"";position:absolute;inset:0;background:linear-gradient(to top, rgba(0,0,0,.55), rgba(0,0,0,.25));}
    .overlay{position:absolute;inset:0;background:var(--veil);z-index:1}
    .fg{position:relative;z-index:2}
    .pulse{animation:pulse 1.4s ease-in-out infinite}
    @keyframes pulse {0%{opacity:.75} 50%{opacity:1} 100%{opacity:.75}}
    .small{font-size:.9rem;color:var(--muted)}
    .spacer{height:10px}
    a.btn-like{display:inline-block;text-decoration:none}
    /* Ensure images don’t cause layout thrash */
    img.full{width:100%;height:100%;object-fit:cover}
  </style>
</head>
<body>
  <!-- FAIRY SCREEN -->
  <section id="fairy-screen" class="screen active" aria-label="Fairy Gate">
    <div class="bg" id="fairy-bg"></div>
    <div class="overlay"></div>
    <div class="stage fg">
      <div class="card">
        <h1 class="title pulse">Coven Zero · Entry</h1>
        <p class="para">Welcome, seeker. Behold the Fairy at the gate. When you’re ready, press the seal to part the veil and receive the instructions.</p>
        <div class="row">
          <button id="beginBtn">➤ Enter the Instructions</button>
        </div>
        <div class="spacer"></div>
        <p class="small">If the image doesn’t load, the ritual proceeds regardless.</p>
      </div>
    </div>
  </section>

  <!-- INSTRUCTIONS SCREEN -->
  <section id="instructions-screen" class="screen" aria-label="Instructions">
    <div class="stage">
      <div class="card">
        <h2 class="title">The MandemOS Rite</h2>
        <ol class="para">
          <li>Secure an AI companion (any will do).</li>
          <li>Go to the **Human Project** test and complete the First Quest.</li>
          <li>Return with proof. The Fairy will accept your sacrifice.</li>
        </ol>
        <div class="row">
          <a class="btn-like" href="#" id="toTest"><button>Open the Human Project</button></a>
          <button id="toAltar">I have returned — take my proof</button>
          <button id="backToFairy">⟲ Back</button>
        </div>
      </div>
    </div>
  </section>

  <!-- ALTAR SCREEN -->
  <section id="altar-screen" class="screen" aria-label="Altar">
    <div class="stage">
      <div class="card">
        <h2 class="title">The Altar</h2>
        <p class="para">Lay down your sacrifices:</p>
        <div class="row">
          <input id="sac1" placeholder="First Sacrifice — your self laid bare" style="flex:1;min-width:260px;padding:10px;border-radius:8px;border:1px solid #2a2a37;background:#0f0f13;color:#eaeaea" />
          <input id="sac2" placeholder="Second Sacrifice — your trial in the Human Project" style="flex:1;min-width:260px;padding:10px;border-radius:8px;border:1px solid #2a2a37;background:#0f0f13;color:#eaeaea" />
        </div>
        <div class="spacer"></div>
        <div class="row">
          <button id="divineBtn">Third Sacrifice — let the AI divine the Path</button>
          <button id="backToInstructions">⟲ Back to Instructions</button>
        </div>
        <div class="spacer"></div>
        <p id="altarFlash" class="para" style="display:none">✨ The Altar accepts your offering. The Fairy flashes and the veil ripples…</p>
      </div>
    </div>
  </section>

  <script>
    // === CONFIG ===
    const HUMAN_PROJECT_URL = "https://ahumandesign.com"; // change if needed
    const FAIRY_SOURCES = ["fairy.jpg","fairy.png","fairy.webp"]; // tries in order

    // === SAFE HELPERS ===
    const $ = (id)=>document.getElementById(id);
    function show(id){
      for(const el of document.querySelectorAll(".screen")) el.classList.remove("active");
      $(id).classList.add("active");
    }
    function safeBind(id, fn){
      const el = $(id);
      if(!el){ console.warn("Missing element:", id); return; }
      el.addEventListener("click", (e)=>{
        try{ fn(e); }
        catch(err){ console.error("Handler error for", id, err); alert("A glitch crossed the veil. Check console for details."); }
      });
    }
    function preloadFairy(){
      const bg = $("fairy-bg");
      if(!bg) return;
      (function tryNext(i){
        if(i >= FAIRY_SOURCES.length){ return; }
        const img = new Image();
        img.onload = ()=>{ bg.style.backgroundImage = `url('${FAIRY_SOURCES[i]}')`; };
        img.onerror = ()=>tryNext(i+1);
        img.src = FAIRY_SOURCES[i];
      })(0);
    }

    document.addEventListener("DOMContentLoaded", () => {
      preloadFairy();

      // Navigation
      safeBind("beginBtn", ()=> show("instructions-screen"));
      safeBind("backToFairy", ()=> show("fairy-screen"));
      safeBind("toAltar", ()=> show("altar-screen"));
      safeBind("backToInstructions", ()=> show("instructions-screen"));

      // External link
      safeBind("toTest", (e)=>{
        e.preventDefault();
        window.open(HUMAN_PROJECT_URL, "_blank", "noopener,noreferrer");
      });

      // Altar logic (local flash only; no network calls to avoid freezes)
      safeBind("divineBtn", ()=>{
        const v1 = $("sac1").value.trim();
        const v2 = $("sac2").value.trim();
        if(!v1 || !v2){
          alert("Both sacrifices must be laid down before the Altar accepts them.");
          return;
        }
        const flash = $("altarFlash");
        flash.style.display = "block";
        flash.style.animation = "none";
        // quick reflow to restart animation if you add one later
        void flash.offsetWidth;
        flash.style.animation = "pulse .9s ease-in-out 1";
        // Auto fade after 3s
        setTimeout(()=>{ flash.style.display = "none"; }, 3000);
      });
    });
  </script>
</body>
</html>
